# 前言
总体来说寒冰佬出的题思路还是挺骚，感觉在安卓班上或多或少都有接触，还有中途hook函数加载流程，记录内存地址，将一些key进行了替换，这步是挺骚的，虽然直接也有见过一些题，不过在安卓上，直接修改字节码的操作，倒是第一次，感觉蛮新的，也让我知道了，有时候不能过于相信静态分析的结果，一定要动调，避开一些坑

# 0x01
先创建一个自定义classloader，加载asserts下的b.txt文件，这个txt文件实际上就是一个dex文件，010查看了一下文件头，验证了一波，发现就是和之前安卓课上一代加壳的动态加载是一个东西，把classloader替换成自定义的classloader，然后就可以加载对应dex中的类文件，记载了"com.kanxue.crackme.Crack"
# 0x02
用jeb3再次打开那个dex文件，然后直接找到了对应的关键代码，发现其实逻辑也挺清晰，首先先做了一次rc4加密，然后在进行一次“com.kanxue.crackme.Myfcrack"中的native函数crackjni的加密处理，然后再进行一次rc4，最后在进行base64加密

# 0x03
ida打开so文件，直接进行操作，动态调试，同时字符串的长度为16，这很关键否则无法下断点，当时疯狂卡在那里，微信群还问了一些憨批问题，不过有意思的是，倒是学习了一些骚操作，比如frida hook native，直接hook strstr这个libc函数，可以直接绕过，然后就是直接hook对应的加密函数，看那个加密函数，我感觉有插件的话，还是挺香的，毕竟机器识别的话还是挺快的，很快发现是一个aes加密，大体的加密过程没怎么变，也就是密钥拓展算法看上去不一样，但是只是形式不一样而已，后面验证是一样的，有些wp说没看见逆s盒，我都看到了。。。

# 0x04 
继续往下调试，发现莫名发现了dex文件头，然后似乎修改了字节码，然后发现是把结果，还有最后一次的加密的rc4的key给换了

剩下就是把换完的key取出来，直接解密就好了。这波大意了呀，没有闪